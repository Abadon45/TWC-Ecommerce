{% load static %}
{% load url_with_domain %}
{% load currency_filters %} 

<header class="header">

    <!-- header top -->
    <div class="header-top">
        <div class="container">
            <div class="header-top-wrapper">
                {% if user.is_authenticated and user.is_superuser %}
                <div class="row">
                    <div class="col-12 col-md-6 col-lg-6 col-xl-5">
                        <div class="header-top-left">
                            <ul class="header-top-list">
                                {% if settings.IS_PRODUCTION %}
                                <li><a href="admin.twconline.store"><i class="fa-solid fa-user-secret"></i></i>ADMIN</a></li>
                                {% else %}
                                <li><a href="admin.twconline.store:8000"><i class="fa-solid fa-user-secret"></i></i>ADMIN</a></li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-6 col-xl-7">
                        <div class="header-top-right">
                            <ul class="header-top-list">
                                <li><a href="{% url_with_domain 'products:product_list' %}"><i class="fa-solid fa-code-compare"></i> Product List</a></li>
                                <li><a href="{% url_with_domain 'products:add_product' %}"><i class="fa-solid fa-keyboard"></i> Add Products</a></li>
                                {% if user.is_authenticated %}
                                <li class="login"><a href="{% url_with_domain 'login:logout' %}"><i class="far fa-arrow-right-to-arc"></i> Logout</a></li>
                                {% else %}
                                <li class="login"><a href="{% url_with_domain 'login:login' %}"><i class="far fa-arrow-right-to-arc"></i> Login</a></li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="row">  
                    <div class="col-12 col-md-6 col-lg-6 col-xl-5">
                        <div class="header-top-left">
                            <!-- <ul class="header-top-list">
                                <li><a href="mailto:info@example.com"><i class="far fa-envelopes"></i>
                                        info@example.com</a></li>
                                <li><a href="tel:+21236547898"><i class="far fa-headset"></i> +2 123 654
                                        7898</a></li>
                            </ul> -->
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-6 col-xl-7">
                        <div class="header-top-right">
                            <ul class="header-top-list">
                                {% if user.is_authenticated %}
                                <li class="login"><a href="{% url_with_domain 'login:logout' %}"><i class="far fa-arrow-right-to-arc"></i> Logout</a></li>
                                {% else %}
                                <li class="login"><a href="{% url_with_domain 'login:login' %}"><i class="far fa-arrow-right-to-arc"></i> Login</a></li>
                                {% endif %}
                                <li class="social">
                                    <div class="header-top-social">
                                        <span>Follow Us: </span>
                                        <a href="#"><i class="fab fa-facebook"></i></a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>       
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- header middle -->
    <div class="header-middle">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-5 col-lg-3 col-xl-3">
                    <div class="header-middle-logo">
                        <a class="navbar-brand" href="{{ MAIN_SITE_URL }}">
                            <img src="{% static 'img/logo/logo.png' %}" alt="logo">
                        </a>
                    </div>
                </div>
                <div class="d-none d-lg-block col-lg-6 col-xl-5">
                    <div class="header-middle-search">
                        <form method="get" action="{% url 'shop:search' %}">
                            <div class="search-content">
                                <input type="text" class="form-control" name="q" placeholder="Search Here...">
                                <button type="submit" class="search-btn"><i class="far fa-search"></i></button>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col-7 col-lg-3 col-xl-4">
                    <div class="header-middle-right">
                        <ul class="header-middle-list">
                            {% if user.is_authenticated %}
                                <li><a href="{{ DASHBOARD_URL }}" class="list-item"><i class="far fa-user-circle"></i></a></li>
                                <!-- <li><a href="{{ DASHBOARD_URL }}" class="list-item wishlist" placeholder="wishlist"><i class="far fa-heart"></i><span>0</span></a></li> -->
                            {% else %}
                                
                            {% endif %}
                            
                            <li id="cart-link" class="dropdown-cart">
                                    <a href="{% url_with_domain 'cart:cart' %}" class="shop-cart list-item"><i class="far fa-shopping-bag"></i>
                                    <span id="upper-cart-count">{{ cart_items }}</span></a>
                                    <div id="cart-dropdown">
                                        {% if cart_items %}
                                        <div class="dropdown-cart-menu">
                                            <div class="dropdown-cart-header">
                                                <span class="cart-items-count">{{ cart_items|stringformat:"02d" }} Items</span>
                                                <a href="{% url_with_domain 'cart:cart' %}">View Cart</a>
                                            </div>
                                            <ul class="dropdown-cart-list"> 
                                                {% for order, items in ordered_items.items %}
                                                    {% for item in items %}
                                                    <li id="cart-row-{{item.product.id}}">
                                                        <div class="dropdown-cart-item">
                                                            <div class="cart-img">
                                                                <a href="{% url 'shop:single' slug=item.product.slug %}">
                                                                    {% if item.product.image_1 %}
                                                                        {% if item.product.image_1.url %}
                                                                            <img src="{{ item.product.image_1.url }}" alt="{{ item.product.name }}">
                                                                        {% else %}
                                                                            <img src="{% static 'img/product/default-product-image.png' %}" alt="{{ item.product.name }}">
                                                                        {% endif %}
                                                                    {% else %}
                                                                        <img src="{% static 'img/product/default-product-image.png' %}" alt="{{ item.product.name }}">
                                                                    {% endif %}
                                                                </a>
                                                            </div>
                                                            <div class="cart-info">
                                                                <h4><a href="{% url 'shop:single' slug=item.product.slug %}">{{item.product.name}}</a></h4>
                                                                <p class="cart-qty">{{ item.quantity }}x - <span
                                                                        class="cart-amount">{{ item.get_total|currency }}</span></p>
                                                            </div>
                                                            <a href="#" data-product="{{ item.product.id }}"
                                                            data-action="remove" class="update-cart shop-cart-remove">
                                                            <i class="far fa-times-circle"></i></a>
                                                        </div>
                                                    </li>
                                                    {% endfor %}
                                                {% endfor %}
                                            </ul>
                                            <div class="dropdown-cart-bottom">
                                                <div class="dropdown-cart-total">
                                                    <span>Total</span>
                                                    <span class="total-amount">{{ total_cart_subtotal|currency }}</span>
                                                </div>
                                                <a href="{% url_with_domain 'cart:cart' %}" class="theme-btn">Checkout</a>
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div> 
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="header-middle-line">
            <div class="line-1">1</div>
            <div class="line-2">2</div>
            <div class="line-3">3</div>
            <div class="line-4">4</div>
            <div class="line-5">5</div>
            <div class="line-6">5</div>
        </div>
    </div>
    

    <!-- header main navigation -->
    <div class="main-navigation">
        <nav class="navbar navbar-expand-lg">
            <div class="container position-relative">
                <a class="navbar-brand" href="{{ MAIN_SITE_URL }}">
                    <img src="{% static 'img/logo/logo.png' %}" class="logo-scrolled" alt="logo">
                </a>
                <div class="category-all">
                    <!-- <button class="category-btn" type="button">
                        <i class="far fa-grid-2-plus"></i><span>All Categories</span>
                    </button> -->
                    <ul class="main-category hide-category">
                        <li>
                            <a href="#">
                                <span><b>New Arrivals</b></span><i class="far fa-angle-right"></i>
                            </a>
                            <ul class="sub-category">
                                <li><a href="#"><span>Place context here</span></a></li>
                            </ul>               
                        </li>
                        <li>
                            <a href="#">
                                <span>Fashion & Accessories</span><i class="far fa-angle-right"></i>
                            </a>
                            <div class="sub-category-mega">
                                <div class="row">
                                    <div class="col-lg-4">
                                        <div class="category-single">
                                            <a href="#" class="category-title">Shop Kid's</a>
                                            <div class="category-img mb-3">
                                                <img src="{% static 'img/category/01.jpg' %}" alt="#">
                                            </div>
                                            <div class="category-link">
                                                <a href="#">Kids Toys</a>
                                                <a href="#">Kids Color Shape</a>
                                                <a href="#">Kids Travel Car</a>
                                                <a href="#">Kids Tent</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="category-single">
                                            <a href="#" class="category-title">Shop Men's</a>
                                            <div class="category-img mb-3">
                                                <img src="{% static 'img/category/02.jpg' %}" alt="#">
                                            </div>
                                            <div class="category-link">
                                                <a href="#">Watch</a>
                                                <a href="#">Hoodies</a>
                                                <a href="#">T-shirt</a>
                                                <a href="#">Formal Pant</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4">
                                        <div class="category-single">
                                            <a href="#" class="category-title">Shop Women's</a>
                                            <div class="category-img mb-3">
                                                <img src="{% static 'img/category/03.jpg' %}" alt="#">
                                            </div>
                                            <div class="category-link">
                                                <a href="#">Ladies Shirt</a>
                                                <a href="#">Ladies Sun Glass</a>
                                                <a href="#">Ladies Frog</a>
                                                <a href="#">Ladies Watch</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        {% for category in categories %}
                        <li>
                            <a href="#"><span>{{ category_name }}</span></a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="mobile-menu-right">
                    <div class="search-btn">
                        <button type="button" class="nav-right-link"><i class="far fa-search"></i></button>
                        <div class="mobile-search-form">
                            <form method="get" action="{% url 'shop:search' %}">
                                    <input type="text" class="form-control" name="q" placeholder="Search Here...">
                                    <button type="submit"><i class="far fa-search"></i></button>
                            </form>
                        </div>
                    </div>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#main_nav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-mobile-icon"><i class="far fa-bars"></i></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse" id="main_nav">
                    <ul class="navbar-nav">
                        <li class="nav-item"><a class="nav-link" href="{% url_with_domain 'home_view' %}">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="{% url_with_domain 'shop:shop' %}">Shop</a></li>
                        {% if user.is_seller or user.is_staff %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle active" href="#" data-bs-toggle="dropdown">My Account</a>
                            <ul class="dropdown-menu fade-down">
                                <li>
                                    <a class="dropdown-item" href="{{ user.referred_by.messenger_link }}" id="user-chat-seller">
                                    Chat With Seller</a>
                                </li>
                                {% if user.is_seller %}
                                    <li><a class="dropdown-item" href="{{ DASHBOARD_URL|add:'/seller' }}">Seller Dashboard</a></li>
                                {% endif %}
                                {% if user.is_staff %}
                                    <li><a class="dropdown-item" href="{{ DASHBOARD_URL|add:'/logistics' }}">Logistics Dashboard</a></li>
                                {% endif %}
                                {% if user.is_supplier %}
                                    <li><a class="dropdown-item" href="{{ DASHBOARD_URL|add:'/supplier' }}">Supplier Dashboard</a></li>
                                {% endif %}
                            </ul>
                        </li>
                        {% endif %}
                    {% if not user.is_seller %}
                    <div class="nav-right">
                        <div class="nav-right-btn">
                            <a href="{% url_with_domain 'become_seller' %}" class="theme-btn">Become Seller</a>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </nav>
    </div>

</header>